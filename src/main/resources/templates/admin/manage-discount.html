<!doctype html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Document Website</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body class="d-flex flex-column min-vh-100">
<!-- Navbar -->
<header th:insert="fragments/admin-navbar :: navbar"></header>

<!-- Main Content with Sidebar and Main Section -->
<div class="d-flex flex-grow-1">
    <!-- Sidebar -->
    <aside th:insert="fragments/sidebar :: sidebar"></aside>

    <!-- Main Content Area -->
    <main class="flex-grow-1 p-4" style="margin-left: 300px; margin-top: 76px">
        <div class="mt-5">
            <!-- Page Title -->
            <div class="row">
                <div class="col-12">
                    <h1 class="mb-4">Manage Vouchers</h1>
                </div>
            </div>

            <!-- Search and Filter -->
            <div class="row mb-4">
                <!-- Search -->
                <div class="col-md-6">
                    <input
                            type="text"
                            class="form-control"
                            id="searchInput"
                            placeholder="Search voucher by code, discount percentage..."
                            onkeyup="searchVoucher()"
                    />
                </div>
                <!-- Filter -->
                <div class="col-md-6">
                    <div class="d-flex gap-2">
                        <input type="date" class="form-control" id="filterStartDate" placeholder="Start Date">
                        <input type="date" class="form-control" id="filterEndDate" placeholder="End Date">
                        <button class="btn btn-primary" onclick="filterVoucher()">Filter</button>
                    </div>
                </div>
            </div>

            <!-- Add New Promo Code -->
            <div class="row mb-4">
                <div class="col-md-8">
                    <div class="card">
                        <div class="card-header bg-dark text-white">
                            Add Voucher
                        </div>
                        <div class="card-body">
                            <form>
                                <div class="mb-3">
                                    <label for="promoCode" class="form-label">Code</label>
                                    <input type="text" id="promoCode" class="form-control" placeholder="Enter promo code">
                                </div>
                                <div class="mb-3">
                                    <label for="discountValue" class="form-label">Discount (%)</label>
                                    <input type="number" id="discountValue" class="form-control" placeholder="Enter discount value">
                                </div>
                                <div class="mb-3">
                                    <label for="limit" class="form-label">Limit</label>
                                    <input type="number" id="limit" class="form-control" placeholder="Enter usage limit">
                                </div>
                                <button type="submit" class="btn btn-primary">Add</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Promo Codes Table -->
            <div class="row">
                <div class="col-12">
                    <h2 class="h4 mb-3">Existing Vouchers</h2>
                    <table class="table table-bordered table-striped">
                        <thead class="table-dark">
                        <tr>
                            <th>#</th>
                            <th>Promo Code</th>
                            <th>Discount (%)</th>
                            <th>Used</th>
                            <th>Limit</th>
                            <th>Start Date</th>
                            <th>End Date</th>
                            <th>Actions</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr>
                            <td>1</td>
                            <td>SUMMER2024</td>
                            <td>20</td>
                            <td>15</td>
                            <td>50</td>
                            <td>2024-06-01</td>
                            <td>2024-06-30</td>
                            <td>
                                <button class="btn btn-primary btn-sm" onclick="openEditVoucherModal('SUMMER2024')">Edit</button>
                                <button class="btn btn-danger btn-sm">Delete</button>
                            </td>
                        </tr>
                        <tr>
                            <td>2</td>
                            <td>WELCOME10</td>
                            <td>10</td>
                            <td>8</td>
                            <td>20</td>
                            <td>2024-01-01</td>
                            <td>2024-01-31</td>
                            <td>
                                <button class="btn btn-primary btn-sm" onclick="openEditVoucherModal('WELCOME10')">Edit</button>
                                <button class="btn btn-danger btn-sm">Delete</button>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

    </main>
</div>
<!-- Footer -->
<footer th:insert="fragments/footer :: footer"></footer>
<!-- Modal for Editing Voucher -->
<div class="modal fade" id="editVoucherModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <form id="editVoucherForm">
                <div class="modal-header">
                    <h5 class="modal-title">Edit Voucher</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="promoCode" class="form-label">Promo Code</label>
                        <input type="text" class="form-control" id="promoCode" readonly>
                    </div>
                    <div class="mb-3">
                        <label for="discount" class="form-label">Discount (%)</label>
                        <input type="number" class="form-control" id="discount" required>
                    </div>
                    <div class="mb-3">
                        <label for="used" class="form-label">Used</label>
                        <input type="number" class="form-control" id="used" required>
                    </div>
                    <div class="mb-3">
                        <label for="limit" class="form-label">Limit</label>
                        <input type="number" class="form-control" id="limit" required>
                    </div>
                    <div class="mb-3">
                        <label for="startDate" class="form-label">Start Date</label>
                        <input type="date" class="form-control" id="startDate" required>
                    </div>
                    <div class="mb-3">
                        <label for="endDate" class="form-label">End Date</label>
                        <input type="date" class="form-control" id="endDate" required>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-primary">Save</button>
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                </div>
            </form>
        </div>
    </div>
</div>
<script>
    function openEditVoucherModal(promoCode) {
        // Example data - Replace with backend data as needed
        const voucherData = {
            'SUMMER2024': {
                promoCode: 'SUMMER2024',
                discount: 20,
                used: 15,
                limit: 50,
                startDate: '2024-06-01',
                endDate: '2024-06-30',
            },
            'WELCOME10': {
                promoCode: 'WELCOME10',
                discount: 10,
                used: 8,
                limit: 20,
                startDate: '2024-01-01',
                endDate: '2024-01-31',
            },
        };

        // Fetch data from voucherData
        const voucher = voucherData[promoCode];

        // Fill form data
        document.getElementById('promoCode').value = voucher.promoCode;
        document.getElementById('discount').value = voucher.discount;
        document.getElementById('used').value = voucher.used;
        document.getElementById('limit').value = voucher.limit;
        document.getElementById('startDate').value = voucher.startDate;
        document.getElementById('endDate').value = voucher.endDate;

        // Show modal
        new bootstrap.Modal(document.getElementById('editVoucherModal')).show();
    }

    document.getElementById('editVoucherForm').addEventListener('submit', function (e) {
        e.preventDefault();
        alert('Voucher has been updated!');
        const modal = bootstrap.Modal.getInstance(document.getElementById('editVoucherModal'));
        modal.hide();
    });
</script>
</body>
</html>
